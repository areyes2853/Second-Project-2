<!-- views/fruits/new.ejs -->

<%- include('../partials/header.ejs') %>
  <body>
  

<h1>Add New Pet</h1>

<%# Display error messages if they exist %>
<% if (typeof errorMsg !== 'undefined') { %>
  <p style="color: red;"><%= errorMsg %></p>
<% } %>

<form action="/pets" method="POST">
  <div>
    <label for="name">Name:</label>
    <input type="text" id="name" name="name" required
           value="<%= (typeof formData !== 'undefined' && formData.name) ? formData.name : '' %>">
  </div>
  <div>
    <label for="species">Species:</label>
    <input type="text" id="species" name="species" required
           value="<%= (typeof formData !== 'undefined' && formData.species) ? formData.species : '' %>">
  </div>
  <div>
    <label for="breed">Breed:</label>
    <input type="text" id="breed" name="breed"
           value="<%= (typeof formData !== 'undefined' && formData.breed) ? formData.breed : '' %>">
  </div>
  <div>
    <label for="age">Age:</label>
    <input type="number" id="age" name="age"
           value="<%= (typeof formData !== 'undefined' && formData.age) ? formData.age : '' %>">
  </div>
  <div>
    <label for="ownerId">Owner:</label>
    <select id="ownerId" name="ownerId" required>
      <option value="">-- Select Owner --</option>
      <% if (customers && customers.length > 0) { %>
        <% customers.forEach(customer => { %>
          <option value="<%= customer._id %>"
            <%# Select if form failed validation and this was the previous selection %>
            <% if (typeof formData !== 'undefined' && formData.ownerId === customer._id.toString()) { %>selected<% } %>>
            <%= customer.name %> (<%= customer.email %>)
          </option>
        <% }) %>
      <% } %>
    </select>
  </div>

  <button type="submit">Create Pet</button>
</form>

<a href="/pets">Cancel</a>
<%- include('../partials/footer.ejs') %>


  </body>
</html>
