<%- include('../partials/header.ejs') %>
<body>
 

<h1>Edit Pet: <%= pet.name %></h1>

<%# Display error messages if they exist %>
<% if (typeof errorMsg !== 'undefined') { %>
  <p style="color: red;"><%= errorMsg %></p>
<% } %>

<form action="/pets/<%= pet._id %>?_method=PUT" method="POST">
  <div>
    <label for="name">Name:</label>
    <input type="text" id="name" name="name" value="<%= pet.name %>" required>
  </div>
  <div>
    <label for="species">Species:</label>
    <input type="text" id="species" name="species" value="<%= pet.species %>" required>
  </div>
  <div>
    <label for="breed">Breed:</label>
    <input type="text" id="breed" name="breed" value="<%= pet.breed || '' %>">
  </div>
  <div>
    <label for="age">Age:</label>
    <input type="number" id="age" name="age" value="<%= pet.age || '' %>">
  </div>
  <div>
    <label for="ownerId">Owner:</label>
    <select id="ownerId" name="ownerId" required>
       <option value="">-- Select Owner --</option>
      <% if (customers && customers.length > 0) { %>
        <% customers.forEach(customer => { %>
          <option value="<%= customer._id %>"
            <%# Select the CURRENT owner %>
            <% if (pet.owner && pet.owner.toString() === customer._id.toString()) { %>selected<% } %>>
            <%= customer.name %> (<%= customer.email %>)
          </option>
        <% }) %>
      <% } %>
    </select>
  </div>

  <button type="submit">Update Pet</button>
</form>

<a href="/pets/<%= pet._id %>">Cancel</a> |
<a href="/pets">Back to Pets List</a>

<%- include('../partials/footer.ejs') %>
    
</body>
</html>